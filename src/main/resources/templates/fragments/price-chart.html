<html xmlns:th="http://www.thymeleaf.org">
<div class="container" th:fragment="price-chart (metroId, history)">
    <div class="row">
        <script type="text/javascript" th:inline="javascript">
            google.charts.setOnLoadCallback(drawBackgroundColor);

            function drawBackgroundColor() {
                var chart = new google.visualization.LineChart(document.getElementById(/*[[${metroId}]]*/));

                var cols = [{'id': 'X', 'label': 'Date', 'type': 'date'}];
                var colsData = /*[[${history.columns}]]*/ [];
                colsData.forEach(function(col) {
                    cols.push({'id': col, 'label': col, 'type': 'number'});
                });

                var rows = [];
                var rowsData = /*[[${history.rows}]]*/ [];
                Object.keys(rowsData).forEach(function(date) {
                    var c = [];
                    var rowValues = rowsData[date];
                    console.log('dateKey: ' + date);
                    c.push({v: new Date(date)});

                    rowValues.forEach(function (val) {
                        c.push({v: val});
                    });

                    rows.push({'c': c});
                });

                var initData = new google.visualization.DataTable({
                    'cols': cols,
                    'rows': rows
                });

                var initOptions = {
                    hAxis: {
                        title: 'Date'
                    },
                    vAxis: {
                        title: 'Price'
                    },
                    backgroundColor: '#f1f8e9'
                };

                chart.draw(initData, initOptions);
            }
        </script>
        <div class="col">
            <div th:id="${metroId}"></div>
        </div>
        <div class="col-md-auto">
            <div class=" btn-group-vertical">
                <button type="button" class="btn btn-secondary">Week</button>
                <button type="button" class="btn btn-secondary">Month</button>
                <button type="button" class="btn btn-secondary">Quarter</button>
                <button type="button" class="btn btn-secondary">Year</button>
            </div>
        </div>
    </div>
    <!--<div th:text="${@productService.getPriceHistory(-->
            <!--__${id}__,-->
            <!--T(org.naivs.perimeter.metro.assistant.data.enums.HistoryRange).MONTH)-->
        <!--}">...</div>-->
</div>
</html>
